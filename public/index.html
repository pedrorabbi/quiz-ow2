<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Quiz Offer Wall</title>

    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="./js/translation.js"></script>
    <script src="./script.js"></script>
  </head>
  <body style="margin: 0; padding: 10px">
    <!-- Loader de página inteira para tradução -->
    <div id="page-loader" class="page-loader-overlay" style="display: none">
      <div class="loader-content">
        <div class="spinner"></div>
        <span id="loader-text">Traduzindo...</span>
      </div>
    </div>

    <!-- Modal de sucesso -->
    <div id="success-modal" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <span class="material-symbols-rounded success-icon"
            >check_circle</span
          >
          <h2>Quiz criado com sucesso!</h2>
        </div>
        <div class="modal-body">
          <p>
            Seu quiz foi criado e o link está disponível.
            <br />
            Você também pode copiar o código HTML abaixo:
          </p>
          <div class="code-actions">
            <button id="copy-html-btn" class="copy-button">
              <span class="material-symbols-rounded">content_copy</span>
              Copiar código HTML
            </button>
          </div>
        </div>
        <div class="modal-footer">
          <button id="close-modal-btn" class="close-button">Fechar</button>
        </div>
      </div>
    </div>
    <div style="display: flex; gap: 20px; max-width: 1200px; margin: 0 auto">
      <!-- Lado esquerdo: Formulário -->
      <div style="flex: 1; max-width: 500px">
        <h1>Criação de Quiz com Offer Wall</h1>

        <!-- Dropdown de tradução no topo -->
        <div id="translationSection" style="margin-bottom: 20px; padding: 15px; border-radius: 8px; background: #f0f9ff">
          <div style="display: flex; flex-direction: column; gap: 10px">
            <span style="font-size: 14px; color: #666">
              Traduzir campos <b>preenchidos</b>:
            </span>
            <select id="liveTranslateSelect" style="padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px">
              <option value="">Selecione um idioma...</option>
            </select>
            <div id="liveTranslateStatus" style="font-size: 12px; color: #666; min-height: 16px"></div>
          </div>
        </div>

        <!-- Container principal do formulário do quiz -->
        <div style="display: flex; flex-direction: column; gap: 10px">
          <!-- Campo para nome do quiz (oculto) -->
          <div class="floating-label-group" style="display: none">
            <input type="text" id="quizName" placeholder=" " />
            <label for="quizName">Nome do Quiz</label>
          </div>

          <!-- Campo para vertical do quiz -->
          <div class="floating-label-group">
            <input type="text" id="vertical" placeholder=" " />
            <label for="vertical">Vertical</label>
          </div>

          <!-- Campo para domínio do quiz -->
          <div class="floating-label-group">
            <input type="text" id="domain" placeholder=" " />
            <label for="domain">Domínio</label>
          </div>

          <hr />

          <!-- Checkbox para controlar retenção -->
          <div
            style="
              display: flex;
              align-items: center;
              gap: 8px;
              margin: 5px 0 10px 0;
            "
          >
            <input type="checkbox" id="withRetention" checked />
            <label for="withRetention" style="margin: 0; cursor: pointer"
              >Com retenção</label
            >
          </div>

          <!-- Campo para label do anúncio (oculto) -->
          <div class="floating-label-group" style="display: none">
            <input type="text" id="adLabel" placeholder=" " />
            <label for="adLabel">Ad Label</label>
          </div>

          <!-- Campo para título do quiz -->
          <div class="floating-label-group">
            <input type="text" id="title" placeholder=" " />
            <label for="title">Título</label>
          </div>

          <!-- Campo para subtítulo/greeting do quiz (oculto) -->
          <div class="floating-label-group" style="display: none">
            <input type="text" id="greeting" placeholder=" " />
            <label for="greeting">Subtítulo/Greeting</label>
          </div>

          <!-- Campo para descrição do quiz (oculto) -->
          <div class="floating-label-group" style="display: none">
            <input type="text" id="description" placeholder=" " />
            <label for="description">Descrição</label>
          </div>

          <!-- Campos de retenção (nome e email) -->
          <div id="retentionFields" style="flex-direction: column; gap: 10px">
            <!-- Campo para label do nome -->
            <div class="floating-label-group">
              <input type="text" id="nameLabel" placeholder=" " />
              <label for="nameLabel">Label Nome</label>
            </div>

            <!-- Campo para label do email -->
            <div class="floating-label-group">
              <input type="text" id="emailLabel" placeholder=" " />
              <label for="emailLabel">Label Email</label>
            </div>
          </div>

          <!-- Campo para texto do botão -->
          <div class="floating-label-group">
            <input type="text" id="buttonText" placeholder=" " />
            <label for="buttonText">Texto do botão final</label>
          </div>

          <!-- Campo para rodapé -->
          <div class="floating-label-group">
            <input type="text" id="footnote" placeholder=" " />
            <label for="footnote">Rodapé</label>
          </div>

          <!-- Campo para mensagem skipForm -->
          <div class="floating-label-group">
            <input type="text" id="skipForm" placeholder=" " />
            <label for="skipForm">Mensagem Skip Form</label>
          </div>

          <hr />

          <!-- Seletores de cor para personalização do quiz -->
          <div class="colorRow">
            <label for="primaryColor">Cor Primária:</label>
            <div class="colorInputWrapper">
              <input type="color" id="primaryColor" value="#22C55D" />
            </div>
          </div>

          <div class="colorRow">
            <label for="secondaryColor">Cor Secundária:</label>
            <div class="colorInputWrapper">
              <input type="color" id="secondaryColor" value="#16A349" />
            </div>
          </div>

          <div class="colorRow">
            <label for="hoverColor">Cor de Hover:</label>
            <div class="colorInputWrapper">
              <input type="color" id="hoverColor" value="#16A349" />
            </div>
          </div>

          <!-- Container onde as perguntas do quiz serão adicionadas dinamicamente -->
          <div
            id="questionsContainer"
            style="display: flex; flex-direction: column; gap: 20px"
          >
            <!-- Perguntas serão adicionadas aqui -->
          </div>

          <!-- Botões para adicionar perguntas, loader e criar o quiz -->
          <div style="display: flex; flex-direction: column; gap: 10px">
            <div style="display: flex; gap: 10px">
              <button onclick="addQuestion()">Adicionar Pergunta</button>
              <button onclick="addLoader()">Adicionar Loader</button>
            </div>
            <button onclick="createHtmlTemplate()">Criar Quiz</button>
          </div>
        </div>

        <!-- Área para exibir resposta da API após submissão -->
        <div
          id="apiResponse"
          style="display: flex; justify-content: center; margin-top: 10px"
        ></div>

        <!-- Área para exibir link gerado após criação do template -->
        <div
          id="linkResponse"
          style="
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin-top: 10px;
            text-align: center;
          "
        ></div>
      </div>

      <!-- Lado direito: Preview -->
      <div style="flex: 1; position: sticky; top: 20px; height: fit-content">
        <div
          style="
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-bottom: 15px;
          "
        >
          <button
            onclick="resetPreview()"
            style="
              padding: 6px 12px;
              background: white;
              color: #666;
              border: 1px solid #ddd;
              border-radius: 4px;
              font-size: 12px;
              cursor: pointer;
              width: fit-content;
              flex: 0;
              white-space: nowrap;
            "
          >
            Reset Preview
          </button>
        </div>
        <div
          id="quizPreview"
          style="
            border: 1px solid #ccc;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 20px;
          "
        >
          <!-- Barra de progresso fixa no topo -->
          <div
            id="topProgressBar"
            style="
              width: 100%;
              height: 4px;
              background-color: #e0e0e0;
              position: relative;
            "
          >
            <div
              id="topProgressFill"
              style="
                height: 100%;
                background-color: #22c55d;
                width: 0%;
                transition: width 0.3s ease;
              "
            ></div>
          </div>

          <div id="previewContent" style="padding: 20px">
            <div
              id="previewHeader"
              style="text-align: center; margin-bottom: 20px"
            >
              <div
                id="previewAdLabel"
                style="
                  font-size: 12px;
                  color: #666;
                  margin-bottom: 5px;
                  display: none;
                "
              >
                Ad Label
              </div>
              <h3
                id="previewTitle"
                style="margin: 0 0 10px 0; color: #333; display: none"
              >
                Título do Quiz
              </h3>
              <p
                id="previewGreeting"
                style="margin: 0; color: #666; font-size: 14px; display: none"
              >
                Subtítulo do quiz
              </p>
            </div>

            <div id="previewQuestions">
              <div class="preview-question" style="margin-bottom: 20px">
                <h4 style="margin: 0 0 15px 0; color: #333">
                  Pergunta de exemplo
                </h4>
                <div class="preview-options">
                  <button
                    class="preview-option"
                    style="
                      display: block;
                      width: 100%;
                      padding: 12px;
                      margin: 8px 0;
                      border: none;
                      border-radius: 6px;
                      cursor: pointer;
                      font-size: 14px;
                    "
                  >
                    Opção 1
                  </button>
                  <button
                    class="preview-option"
                    style="
                      display: block;
                      width: 100%;
                      padding: 12px;
                      margin: 8px 0;
                      border: none;
                      border-radius: 6px;
                      cursor: pointer;
                      font-size: 14px;
                    "
                  >
                    Opção 2
                  </button>
                </div>
              </div>
            </div>

            <div id="previewForm" style="margin-top: 20px; display: none">
              <h4
                id="previewDescription"
                style="margin: 0 0 20px 0; color: #333; display: none"
              >
                Descrição do formulário
              </h4>
              <div id="previewNameInputContainer" style="margin-bottom: 12px">
                <input
                  id="previewNameInput"
                  type="text"
                  placeholder="Seu nome"
                  style="
                    width: 100%;
                    padding: 12px;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    box-sizing: border-box;
                  "
                />
              </div>
              <div id="previewEmailInputContainer" style="margin-bottom: 12px">
                <input
                  id="previewEmailInput"
                  type="email"
                  placeholder="Seu email"
                  style="
                    width: 100%;
                    padding: 12px;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    box-sizing: border-box;
                  "
                />
              </div>
              <button
                id="previewButton"
                style="
                  width: 100%;
                  padding: 15px;
                  border: none;
                  border-radius: 6px;
                  font-size: 16px;
                  font-weight: bold;
                  cursor: pointer;
                  color: white;
                "
              >
                Enviar
              </button>
              <p
                id="previewFootnote"
                style="
                  font-size: 12px;
                  color: #666;
                  text-align: center;
                  margin-top: 20px;
                "
              >
                Rodapé do formulário
              </p>
            </div>
          </div>
        </div>

        <!-- Histórico de Quizzes -->
        <div
          id="quizHistory"
          style="
            border: 1px solid #ccc;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 15px;
          "
        >
          <h3 style="margin: 0 0 15px 0; font-size: 16px; color: #333">
            Histórico
          </h3>
          <div id="historyList" style="display: flex; flex-direction: column; gap: 10px">
            <!-- Histórico será preenchido aqui -->
          </div>
          <div id="noHistory" style="color: #666; font-size: 14px; text-align: center; padding: 20px">
            Nenhum quiz criado ainda
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
